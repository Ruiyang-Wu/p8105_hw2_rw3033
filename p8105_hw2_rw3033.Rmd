---
title: "p8105_hw2_rw3033"
output: github_document
---


# Problem 1
Read the data
```{r}
library(tidyverse)

prob1_df = read_csv(file = "~/Desktop/BIST8105/HW/p8105_hw2_rw3033/NYC_Transit_Subway_Entrance_And_Exit_Data.csv", na = c(".", "NA", ""))
view(prob1_df)
```

Clean the data
Convert the entry variable
```{r}
prob1_df = prob1_df |>
  janitor::clean_names() |>
  select(line, station_name, station_latitude, station_longitude, 
         route1:route11, entry, vending, entrance_type, ada) |>
  mutate(entry = str_trim(entry), 
         entry = ifelse(entry == "YES", TRUE, FALSE))

str(prob1_df)
view(prob1_df)
```
Variables:
This dataset contains 1,868 rows and 19 columns.
Line, Station Name, Route1 to Route7, vending, Entrance Type are character variables.
Station Latitude, Station Longitude, Route8 to Route11 numeric variables.
Entry and ADA are logical variables.

Data Cleaning Steps:
The column names were cleaned using janitor::clean_names() to standardize the format, making them all lowercase and replacing spaces with underscores.
Only the relevant columns were selected for further analysis: line, station_name, station_latitude, station_longitude, route1 through route11, entry, vending, entrance_type, and ada.
The entry column, initially containing "YES" and "NO", was converted into a logical format (TRUE for "YES" and FALSE for "NO").

Tidiness:
The dataset is not tidy because it contains NA values, and the subway routes are inconsistently representedâ€”some are stored as character (chr) variables while others are stored as numeric (num). This inconsistency makes it difficult to work with the data in a uniform way, as all routes should ideally be represented in a single, consistent format.

Answer questions:
```{r}
library(dplyr)

# 1. How many distinct stations are there?
distinct_stations_count = prob1_df |>
  distinct(station_name, line) |>
  nrow()

distinct_stations_count

# 2. How many stations are ADA compliant?
ada_compliant_stations_count = prob1_df |>
  filter(ada == TRUE) |>
  distinct(station_name, line) |>
  nrow()

ada_compliant_stations_count

# 3. Proportion of station entrances / exits without vending
# Total count of stations without vending
total_count_vending_no = prob1_df |>
  filter(vending == "NO") |>
  nrow()

# Total count of station entrances without vending (entry == TRUE)
count_entry_true_without_vending = prob1_df |>
  filter(vending == "NO", entry == TRUE) |>
  nrow()

# Total count of station exits without vending (entry == FALSE)
count_entry_false_without_vending = prob1_df |>
  filter(vending == "NO", entry == FALSE) |>
  nrow()

# Proportion of station entrances without vending (entry == TRUE)
proportion_entrances_without_vending = count_entry_true_without_vending / total_count_vending_no

# Proportion of station exits without vending (entry == FALSE)
proportion_exits_without_vending = count_entry_false_without_vending / total_count_vending_no

# Output the results
proportion_entrances_without_vending
proportion_exits_without_vending
```
How many distinct stations are there? Note that stations are identified both by name and by line (e.g. 125th St 8th Avenue; 125st Broadway; 125st Lenox)?
  465
How many stations are ADA compliant?
  84
What proportion of station entrances / exits without vending allow entrance?
  P(entrances|without vending allow entrance) = 0.3770492
  P(exits|without vending allow entrance) = 0.6229508

```{r}
library(dplyr)
library(tidyr)
library(stringr)

# Reformat data so that route number and route name are distinct variables
prob1_df_long = prob1_df |>
  mutate(across(route1:route11, as.character)) |>
  pivot_longer(cols = starts_with("route"), 
               names_to = "route_number", 
               values_to = "route_name", 
               values_drop_na = TRUE)

head(prob1_df_long)

# 1. How many distinct stations serve the A train?
distinct_stations_A_train = prob1_df_long |>
  filter(route_name == "A") |>
  distinct(station_name, line) |>
  nrow()

distinct_stations_A_train

# 2. How many of the stations that serve the A train are ADA compliant?
ada_compliant_A_train <- prob1_df_long |>
  filter(route_name == "A", ada == TRUE) |>
  distinct(station_name, line) |>
  nrow()

ada_compliant_A_train
```
How many distinct stations serve the A train? 
  60
Of the stations that serve the A train, how many are ADA compliant?
  17


# Problem 2
```{r}
# Mr. Trash Wheel
library(readxl)
library(dplyr)
library(skimr)
library(tidyr)

# Read the Excel file and specify column types
MrTrashWheel_df = read_excel(
  path = "~/Desktop/BIST8105/HW/p8105_hw2_rw3033/202409 Trash Wheel Collection Data.xlsx", 
  sheet = "Mr. Trash Wheel", 
  na = c("NA", ".", ""))|>
  select(-...15, -...16) |>
  # Use reasonable variable names
  janitor::clean_names() |>
  # Omit rows that do not include dumpster-specific data
  drop_na(dumpster)|>
  # Round the number of sports balls to the nearest integer and convert the result to an integer variable
  mutate(sports_balls = as.integer(round(sports_balls)))|>
  mutate(year = as.numeric(year))|>
  # Add source
  mutate(source = "Mr. Trash Wheel")

str(MrTrashWheel_df)
```

```{r}
# Professor Trash Wheel
library(readxl)
library(dplyr)
library(skimr)
library(tidyr)

# Read the Excel file and specify column types
ProfTrashWheel_df = read_excel(
  path = "~/Desktop/BIST8105/HW/p8105_hw2_rw3033/202409 Trash Wheel Collection Data.xlsx", 
  sheet = "Professor Trash Wheel", 
  na = c("NA", ".", ""))|>
  # Use reasonable variable names
  janitor::clean_names() |>
  # Omit rows that do not include dumpster-specific data
  drop_na(dumpster)|>
  # Add source
  mutate(source = "Professor Trash Wheel")

str(ProfTrashWheel_df)
```

```{r}
# Gwynnda Trash Wheel
library(readxl)
library(dplyr)
library(skimr)
library(tidyr)

# Read the Excel file and specify column types
GwynndaTrashWheel_df = read_excel(
  path = "~/Desktop/BIST8105/HW/p8105_hw2_rw3033/202409 Trash Wheel Collection Data.xlsx", 
  sheet = "Gwynnda Trash Wheel", 
  na = c("NA", ".", ""))|>
  # Use reasonable variable names
  janitor::clean_names() |>
  # Omit rows that do not include dumpster-specific data
  drop_na(dumpster)|>
  mutate(source = "Gwynnda Trash Wheel")

str(GwynndaTrashWheel_df)
```

```{r}
# Combine sheets
TidyTrashWheel_df = 
  bind_rows(MrTrashWheel_df, ProfTrashWheel_df, GwynndaTrashWheel_df)
print(TidyTrashWheel_df)

str(TidyTrashWheel_df)
```
Paragraph about these data:
The dataset (TidyTrashWheel_df) provides a comprehensive summary of waste collection metrics from the "Mr. Trash Wheel" initiative. It consists of 15 variables and 1,033 observations, detailing the amounts of various types of waste collected across different dates. The columns include information on waste collection metrics such as weight_tons, volume_cubic_yards, and various categories of trash items, including plastic_bottles, polystyrene, cigarette_butts, glass_bottles, plastic_bags, wrappers, and sports_balls. The data also captures year as numerical data, month as character data, and the exact date of collection, formatted as POSIXct. Additionally, the source column, stored as character data, indicates the sheet from which each row of data originates.

```{r}
# Questions
library(dplyr)

# What was the total weight of trash collected by Professor Trash Wheel?
total_weight_professor = TidyTrashWheel_df |>
  filter(source == "Professor Trash Wheel") |>
  summarize(total_weight = sum(weight_tons, na.rm = TRUE))  
  
# What was the total number of cigarette butts collected by Gwynnda in June of 2022?
total_cig_butts_gwynnda = TidyTrashWheel_df |>
  filter(source == "Gwynnda Trash Wheel", year == 2022, month == "June")|>
  summarize(total_cigarette_butts = sum(cigarette_butts, na.rm = TRUE)) 

# Print the results
print(total_weight_professor)
print(total_cig_butts_gwynnda)

```
Total weight of trash collected by Professor Trash Wheel: 246.74 tons
Total number of cigarette butts collected by Gwynnda in June of 2022: 18120


# Problem 3
```{r}

```

